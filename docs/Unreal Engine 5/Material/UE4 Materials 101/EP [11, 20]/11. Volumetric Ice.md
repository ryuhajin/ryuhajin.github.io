---
layout: default
title: "11. Volumetric Ice"
parent: "EP [11 , 20]"
nav_order: 2
---

# EP 11 : Volumetric Ice
텍스처가 물체 내부에 존재하는 것처럼 부피감 또는 깊이감 부여하기

- 우리가 보는 각도에 따라 그 내부 요소들의 위치가 달라 보이는 현상을 컴퓨터 그래픽으로 모방
- 이러한 효과를 **시차(Parallax)**라고 부름
- 가까운 물체는 시점을 조금만 옮겨도 많이 움직여 보이고, 먼 물체는 적게 움직여 보이는 원리

---

## 핵심 아이디어
1. 일반 UV → 표면에 고정
2. 카메라 벡터(Camera Vector) + 법선(Normal) → 반사 벡터(Reflection Vector) 계산
3. **반사 벡터를 뒤집어 투과 벡터(Transmission Vector) 로 사용**
4. **이 XY 성분을 UV에 더해주면 카메라 이동에 따라 안쪽에서 텍스처가 움직이는 효과 발생**

---

## reflection vector (반사 벡터)

![](../../../../../images/reflectionVector.png)

---

## 반사 벡터(Reflection Vector) 공식 유도 과정
- **I**: 표면을 향하는 정규화된(길이가 1인) **입사 벡터**
- **N**: 표면에서 바깥을 향하는 정규화된 **법선 벡터**
- **R**: 우리가 구하고자 하는 정규화된 **반사 벡터**

---

### 1단계: 벡터 분해 (Vector Decomposition)
입사 벡터 `I`를 법선 `N`에 평행한 성분($$I_{\parallel}$$)과 수직인 성분($$I_{\perp}$$)의 합으로 분해

> 입사 벡터 I는 위 그림처럼 노멀 벡터 N과 평행한 B, 수직인 A 성분으로 분해할 수 있다

$$I = I_{\parallel} + I_{\perp}$$

---

### 2단계: 평행 성분 계산 (Parallel Component)
`I`를 `N`에 투영(projection)하여 평행 성분 $$I_{\parallel}$$를 구하기
`N`이 단위 벡터이므로, 투영된 길이는 `I · N`, 여기에 방향 벡터 `N`을 곱

$$I_{\parallel} = (I \cdot N)N$$

---

### 3단계: 수직 성분 계산 (Perpendicular Component)
1단계의 식을 변형하여 수직 성분 $$I_{\perp}$$ 구하기

$$I_{\perp} = I - I_{\parallel}$$

2단계의 결과를 대입하면 다음과 같음

$$I_{\perp} = I - (I \cdot N)N$$

---

### 4단계: 반사 벡터 조합 (Assembling Reflection Vector)
반사 벡터는 B를 뒤집고 수직인 A인 그대로 유지하는 변환이다

- 법선에 평행한 성분($$I_{\parallel}$$)의 방향은 뒤집히고, 수직인 성분($$I_{\perp}$$)은 그대로 유지
---

$$R = - I_{\parallel} + I_{\perp} $$

---

### 5단계: 최종 공식 유도 (Final Formula)
4단계의 식에 2, 3단계에서 구한 각 성분을 대입하여 `I`와 `N`만으로 식을 정리

---

$$R = \underbrace{- ((I \cdot N)N)}_{\text{-I}_{\parallel}} + \underbrace{(I - (I \cdot N)N)}_{\text{I}_{\perp}}$$

---

이제 괄호를 풀고 정리하면,

---

$$R = - (I \cdot N)N + I - (I \cdot N)N$$

---

$$R = I - 2 (I \cdot N)N$$

---

**링크**
- [reflection-refraction-fresnel](https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/reflection-refraction-fresnel)
- [Vector reflection at a surface](https://www.sunshine2k.de/articles/coding/vectorreflection/vectorreflection.html)

---
