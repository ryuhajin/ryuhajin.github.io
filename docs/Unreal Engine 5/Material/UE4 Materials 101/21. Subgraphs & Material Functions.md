---
layout: default
title: "21. Subgraphs & Material Functions"
parent: "UE4 Materials 101"
nav_order: 5
---

# EP 21 : Subgraphs & Material Functions
그래프 안의 그래프. 반복되는 쉐이더 로직을 별도 블록으로 묶은 **함수 역할**

- Sub Graph (Unity) 
- Material Function (Unreal)

## Material Functions 장점
1. **그래프 단순화**
- Material Function은 큰 쉐이더 그래프를 기능별로 분할해 가독성을 높이고 성능을 개선
2. **중복 제거**
- 반복되는 로직(예: 매크로·마이크로 디테일)을 다른 마스터 머티리얼에 복사·붙여넣기 대신 함수로 만들어 재사용할 수 있다
3. **한 곳에서 수정**
- 공통 기능 (예: 눈 효과)을 하나의 Sub Graph로 관리하면 여러 쉐이더를 따로 수정할 필요 없이 한 번에 반영
- **그래프 안에서 Material Function 노드 더블 클릭하면 열림**
4. **모듈식 구성**
- 기능 단위로 나뉜 모듈을 쉽게 추가·삭제·이동할 수 있어 작업 효율이 높아짐
5. **로컬 vs 글로벌 효과 분리**
- 예: 바위 텍스처(로컬)와 눈·먼지·마모(글로벌)를 구분해 설계하면 유지보수성이 향상

---

## Material Function 생성
1. Content Browser에서 Right Click
2. Material → 고급 → Material Function 클릭
3. MF_이름 지정 후 열기

---

## Function Input / Output
Function Input / Function Output 노드를 사용해 MF 입출력 결정

**Input Details**
1. 이름 및 설명 설정
2. 데이터 타입 선택
3. Preview Value를 기본값으로 설정할 수 있음
4. Preview를 default로 사용하려면 “Use preview value as default” 체크 필수

> 입출력 인덱스 순서는 Input/Output Details의 Sort Priority로 제어
> - 라이브러리에 노출을 체크해야 다른 쉐이더에서 검색 가능

---

## Texture Object
Texture Object는 **텍스처 샘플링 전 텍스처 자체를 참조하는 핸들이다**

> MF의 Input을 Texture2D 로 만들었을 때 Texture Object를 받아야 함

### Texture Object vs Texture Sample
```
Texture Object
- GPU 메모리에 올라가 있는 순수한 텍스처 데이터 덩어리

Texture Sample
- UV 좌표를 바탕으로 텍스처 오브젝트에서 실제로 픽셀 색상 값을 읽어오는 작업 수행
```

## 정리
1. Texture Sample의 결과물은 이미 샘플링 된 픽셀 색상 데이터이므로 가공하기 적합하지 않음
2. Texture Object는 텍스처 자체이므로 함수 Input으로 적합
    - Texture Object를 받아 내부에서 자유롭게 샘플링

---

**링크**
- [material-functions](https://dev.epicgames.com/documentation/en-us/unreal-engine/material-functions-in-unreal-engine)

