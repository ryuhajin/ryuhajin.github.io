---
layout: default
title: "15. Smoothstep"
parent: "EP [11, 20]"
nav_order: 5
---

# EP 15 : Smoothstep
**값을 0에서 1로 천천히 전환하는 함수로, 선형(LERP)보다 부드러운 시작과 끝(S-curve) 을 만듦**

![](../../../../../images/SmoothSteps.png)

**링크**
- [Smoothstep: The most useful function](https://youtu.be/60VoL-F-jIQ?si=n9PfKiOaeMF_bOtL)

---

## SmoothStep 기본 수식

---

$$
\text{SmoothStep}(x) = t^2 (3 - 2t)
$$

---

$$
t = \text{saturate}\left(\frac{x - edge_1}{edge_2 - edge_1}\right)
$$

---

- **edge1, edge2** : 전환이 시작/끝나는 구간
- **saturate()** : 0~1로 클램핑 `(max(0, min(1, …)))`

> 0~1 구간에서는 곡선 보간을 만들고, 그 외 영역은 평평하게 유지

---

## SmoothStep 노드 구조
- Min : 스무딩 구간의 시작
- Max : 스무딩 구간의 끝
- Input: 0~1 스칼라
- 출력 :  스무스스텝을 사용하여 전환된 값

---

# SmoothStep 사용 예제

## Dissolve
1. **time을 sine으로 변환해 (-1, 1) 사이의 값으로 만든다**
    - 이 값들은 스무스 스텝의 edge1, edge2 (min, max) 값이 됨
2. **노이즈 텍스쳐를 input 값으로 사용**
    - 픽셀마다 0~1 랜덤 분포
3. **Time을 스무스 스텝의 min / max 값으로 연결**
    - 시간에 따라 엣지의 기준이 변함
4. **어떤 픽셀들은 기준보다 낮아서 0이 되고, 어떤 픽셀들은 높아서 1이 됨**
    - 엣지 경계 사이가 SmoothStep의 S자 커브로 부드럽게 퍼짐

- **텍스쳐** : 고정된 값 → 공간 정보 (픽셀별 밝기)
- **time** : 이동하는 경계 값 → 현재 시점에서 어느 픽셀이 통과할지 결정

> 따라서 텍스쳐의 밝기가 현재 time 경계 안에 들어오면 보간, 경계 밖은 0 또는 1로 고정 → dissolve 진행

---

## sizzling
SmoothStep을 두 개 사용하여 경계 발광 시키기

- 기본 식 구조

input 값은 같은 노이즈 텍스쳐 사용

| 이름 | 수식  |
| **Time 입력**             | `sin(time)` |
| **정규화**                 | `sin(time) * 0.5 + 1` |
| **SmoothStep A (첫 번째)** | `minA = timeNorm - 0.5`<br>`maxA = timeNorm - 0.47`  |
| **SmoothStep B (두 번째)** | `minB = timeNorm - 0.53`<br>`maxB = timeNorm - 0.52` |
| **Subtract (B - A)**| `SmoothStep B - SmoothStep A` |


---

- sin(time) 값 변화에 따른 계산표
- 정규화 범위 [0.5 ~ 1.5]


| `timeNorm = sin(t)*0.5 + 1` | A min (`-0.5`) | A max (`-0.47`) | B min (`-0.53`) | B max (`-0.52`) |
| 0.5 | 0.0 | 0.03  | -0.03 | -0.02 |
| 0.75 | 0.25 | 0.28  | 0.22  | 0.23  |
| 1.0 | 0.5  | 0.53  | 0.47  | 0.48  | 
| 1.25 | 0.75 | 0.78  | 0.72  | 0.73  |
| 1.5 | 1.0  | 1.03  | 0.97  | 0.98  |

> SmoothStep B는 빠르고 가파른 엣지가 먼저 켜지고, SmoothStep A는 느리게 따라옴
> - 그 차이(B−A)가 디졸브 경계에서 **얇은 발광 엣지**로 보임

---

### 정리
1. **SmoothStep B**
    - min/max 간 간격이 **0.01**로 매우 좁음
    - **그라데이션이 가파르고 얇은 띠** 형태로 전이
    - 즉, 밝아지는 경계(엣지)가 빠르게 나타난다
2. **SmoothStep A (나중 전이)**
    - B보다 **약간 늦게** 전이 → 같은 형태를 뒤따라가며, **조금 늦게 1로 수렴**
3. **결과 (B−A)**
    - B가 이미 1인데 A는 아직 0~1 사이인 영역만 남음
    - **0~1 사이의 얇은 차이 구간**, 즉 **시각적으로 발광하는 가장자리(엣지)**로 보인다

- **시각적 인상** : A가 B를 따라가기 때문에, 디졸브가 진행될 때 밝은 가장자리가 움직이며 남는 것처럼 보임
- **엣지 폭 제어** : 두 스무스 스텝의 min/max 간격 차이를 조정하면, 엣지 두께를 조절 가능

---

## Height-based Material
특정 구간을 스무스스텝으로 보간

## Absolute World Position
**현재 픽셀의 월드 좌표계 위치 벡터를 반환하는 노드**

- **좌표 단위는 월드 유닛** : 기본적으로 언리얼에선 **1uu = 1cm이다**

### Absolute World Position 예시
월드 상에 큐브 (200×200×200cm)가 바닥(-100)부터 천장(100)까지 배치

| **픽셀 위치**    | **Absolute World Position 출력** |
| 큐브 바닥  | (0, 0, **-100**)           |
| 큐브 중간  | (0, 0, 0)                  |
| 큐브 윗면 | (0, 0, **100**)            |
| 큐브 옆면 | (100, 0, Z값 해당 지점)         |

> 씬 전체의 위치이므로 오브젝트가 움직이면 이 값도 변한다

## bsolute World Position 노드 사용처
이 값은 **어디에 있는지에 따라 머티리얼을 다르게 적용할 때 쓰임**

1. **높이 기반 마스크(Height Mask)**
   - Z값으로 눈, 이끼, 지형 재질 구분
2. **월드 기반 텍스처 타일링**
   - UV 대신 씬의 절대 좌표(X,Y) 를 텍스처의 샘플링 좌표로 사용하여 텍스쳐 공유
3. **방향성 효과**
   - World Position 기반으로 효과를 위쪽에만 입히거나, 특정 영역만 강조

### 주의점
1. **회전**
    - 오브젝트를 회전시켜도 텍스처는 **월드 기준**이므로 고정됨
2. 움직임
    - 오브젝트 이동 시에도 텍스처는 씬에 고정됨

> 해결책 : 필요한 경우 `Object Position`을 빼서 로컬 기준으로 보정 가능

---

## Height-based Material 과정
1. **월드 좌표 높이값 추출**
- `Absolute World Position` 노드 → `Component Mask`로 B(Z) 채널만 사용
2. **기준 높이 정렬 (오프셋 추가)**
- 바닥 높이를 0으로 맞추는 과정
- `Add` 노드로 기준 높이만큼 더한다 (예: 오브젝트가 -130 지점에 있을 경우 +130)
3. **0~1 범위로 정규화 (스케일 곱)**
- `Multiply` 노드로 스케일 값을 곱해 높이를 1로 맞춤
- (예: 천장이 200 → 200 × 0.005 = 1)
4. **SmoothStep으로 높이 구간 선택**
- 스무스스텝을 적용하고 싶은 min,max 값 설정
- (예 : Min 0.5, Max 0.8)
- **0.5 아래는 0, 0.8 위는 1, 그 사이 구간만 부드럽게 보간**
