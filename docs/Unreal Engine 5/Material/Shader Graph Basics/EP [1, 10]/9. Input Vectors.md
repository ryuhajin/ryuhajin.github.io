---
layout: default
title: "9. Input Vectors"
parent: "EP [1, 10]"
nav_order: 6
---

# EP 9 : Input Vectors
## 1. 벡터(Vector)의 개념
- 두 점 사이의 방향과 길이를 가진 선분
- 시작점과 끝점, 혹은 방향을 표현
- 그래픽스에서 중요한 정보 전달
  - 카메라와의 거리 (깊이)
  - 표면이 어느 방향을 향하고 있는지
  - 광원과의 관계 (조명 여부)

---

## 2. 주요 입력 벡터
### (1) Surface Normal (표면 법선 벡터)
- 각 정점(Vertex)에 저장된 **표면이 바라보는 방향**
- 표면에 수직(perpendicular)
- 길이는 항상 1 (정규화된 단위 벡터)
- 활용:
  - 표면의 방향성 판단
  - 카메라, 빛과의 관계 연산(예: dot product)

---

### (2) Camera Vector (뷰 벡터, Eye Vector)
- **카메라 위치 → 표면 위치**로 향하는 벡터
- 길이를 사용하면 "해당 픽셀이 카메라에서 얼마나 먼지" (깊이) 알 수 있음
- Normalized 버전: 단위 길이로 표면이 카메라를 바라보는지 확인 가능
- 활용:
  - Normal과 dot product → 표면이 카메라를 향하면 1 (밝음), 수직이면 0 (어두움).
  - Fresnel 효과(가장자리 강조) 계산

---

### (3) Light Vector (광원 벡터)
- **광원의 위치/방향 → 표면 위치**
- 방향성 광원(태양 등): 방향은 상수
- 점광원(전구 등): 광원 위치 → 표면 위치
- Normal과 dot product → 조명의 밝기 계산 가능
- 단, Unreal/Unity 같은 최신 엔진은 **Deferred Rendering**을 사용하므로, 일반 머티리얼에서는 직접 사용하지 않고 엔진이 나중에 조명 계산을 처리

---

## 3. 예제 활용

### 예제 A: Normal Mask
- dot(Vertex Normal(WS), V3 (0,0,1)) = Z 성분만 마스크
- 표면이 위쪽을 향하면 흰색, 아래면 검정
- 활용: 지면 위 이끼, 눈, 모래 마스크

### 예제 B: Fresnel
- dot(Vertex Normal(WS), CameraDir) → Fresnel
- 표면 정면 = 흰색, 가장자리 = 검정
- Invert(1-x) 하면 반전된 Fresnel
- Power(x,n)으로 효과 강도 조정

### 예제 C: Camera Distance Mask
카메라 거리 값에 따라 흑백 조절

> Absolute World Position 노드 : 현재 셰이딩 중인 지점의 월드 좌표 (표면의 해당 픽셀 위치(WS))

1. Camera Position – Absolute World Position = 표면에서 카메라까지의 벡터 구하기
2. 벡터를 Vector length 노드로 거리 계산 = dist
3. dist - Start Mask(Sclar) = d9 : Subtract
4. t = d0 / Range : Divide
5. saturate(t) = 0 ~ 1 클램프
- 가까움 → 검정, 멈 → 흰색으로 그라데이션
- 활용: 가까울 때만 효과 보이기(예: 디테일 텍스처, 빗방울)

### 헷갈리는 부분 정리
- **Subtract (Start Mask)**
  - 마스크 시작 거리를 설정
  - dist < Start Mask 구간은 0(검정)
  - 예: Start = 500 → 카메라 ~ 500cm 구간은 완전 0

- **Divide(Range)**
  - 0 → 1로 전이되는 거리 폭을 설정
  - Range만큼 이동하는 동안 0에서 1로 선형 상승
  - 예: Range = 5000 → 5m 동안 0 → 1

---

```
Start = 500, Range = 5000 (단위 cm → 5 m, 50 m)

dist=   0   → d0=-500  → t=-0.10 → Color = 0
dist= 500   → d0=   0  → t= 0.00 → Color = 0          // 여기서부터 시작
dist=3000   → d0=2500  → t= 0.50 → Color = 0.5
dist=5500   → d0=5000  → t= 1.00 → Color = 1          // 전이 완료(흰색)
dist=7000   → d0=6500  → t= 1.30 → Color = 1(클램프)
```

---

## Input vector (Unreal vs Unity)

| 구분 | Unreal Engine | Unity |
| **Up 축** | **Z-Up** (법선 Z 사용) | **Y-Up** (법선 Y 사용) |
| **Camera Vector (Direction)** | Camera Vector 노드 → 이미 정규화된 상태 | Camera Direction Node → 방향이 반대라 음수로 만들어야 함 |
