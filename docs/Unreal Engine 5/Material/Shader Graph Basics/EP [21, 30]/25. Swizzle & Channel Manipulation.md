---
layout: default
title: "25. Swizzle & Channel Manipulation"
parent: "EP [21, 30]"
nav_order: 5
---

# EP 25 : Swizzle & Channel Manipulation
채널 조작과 스위즐링

## Channel
쉐이더에서 데이터는 '채널' 또는 '컴포넌트(Component)'라는 단위로 묶여서 처리

1. **색상(Color)**
    - float4(R, G, B, A) - 4개의 채널(빨강, 초록, 파랑, 알파)로 구성
2. **UV 좌표(UV Coordinates)**
    - float2(U, V) - 2개의 채널로 구성
3. **3D 벡터(Vector)**
    - float3(X, Y, Z) - 3개의 채널로 구성

> 채널 조작이란?
> - 이 채널들 안에 담긴 값은 바꾸지 않으면서
> 1. 채널의 순서를 바꾸거나(Swizzling)
> 2. 일부 채널만 추출하거나(Filtering)
> 3. 여러 채널을 합치는(Combining) 모든 행위를 말한다

---

## Channel Manipulation 개념
1. **채널 조작 연산의 비용은 0**
   - 채널 재배열, 마스킹은 비용이 들지 않음. 값 자체의 연산이 없다
2. **채널 = 컴포넌트**
   - 예: 색상 RGBA (=XYZW), UV (=XY)

---

# Channel Manipulation 예제

## Filtering (채널 분리)
특정 채널을 추출하는 경우

1. **언리얼 엔진**
    - `Component Mask` : 노드의 속성에서 R, G, B, A 체크박스 중 원하는 채널만 선택하면 해당 채널들만 출력
    - RGBA -> RGB를 위해 R, G, B만 체크
2. **유니티**
    - `Swizzle` : 노드의 텍스트 필드에 원하는 채널명을 순서대로 입력하면 됨
    - RGBA -> RGB: rgb 또는 xyz 입력
    - RGBA -> R: r 또는 x 입력
  
---

## Combining (채널 결합)
채널을 합쳐 n채널로 만드는 경우

1. **언리얼 엔진**
    - `Append Vector` 노드: 두 개의 입력(A, B)을 받아 순서대로 이어 붙임
    - A 입력에 RGB(float3) + B 입력에 A(float)를 연결하면 RGBA(float4)가 됨
    - 순서가 중요
2. **유니티**
    - Split & Combine 노드: 언리얼보다 과정이 조금 복잡
    - `Split` 노드 : RGB(Vector3)를 R, G, B 채널로 각각 분리
    - `Combine` 노드 : R, G, B, A 입력 핀에 분리된 R, G, B와 별도의 A 값을 각각 연결하여 RGBA를 만든다

---

## Swizzling (채널 순서 변경)
UV 좌표의 U, V 채널 순서를 바꾸면( XY -> YX) 텍스처를 90도 회전시킬 수 있음

1. **언리얼 엔진**
   - `Swizzle` 노드: 이름은 같지만 기능이 매우 제한적
   - XY -> YX 등 몇 가지 정해진 순서 변경만 가능
   - 복잡한 순서 변경(예: RGB -> BGR)을 위해서는
   - `Split Components`로 채널을 모두 분리 -> `Append Many` 노드를 사용해 원하는 순서대로 다시 조립
2. **유니티**
   - `Swizzle` 노드: 텍스트 필드에 원하는 순서 그대로 입력
   - XY -> YX: yx 입력
   - RGB -> BGR: bgr 입력
   - 어떠한 조합이든 자유자재로 만들 수 있음

---

## Replication (채널 복제 및 확장)
하나의 채널을 복제하여 여러 채널로 확장. 흑백의 마스크 텍스처를 float3 회색조 벡터로 만들 때 사용

1. **언리얼 엔진**
    - Append Many를 사용하거나, float3 노드에 단일 채널을 세 번 연결하는 방식으로 구현
2. **유니티**
    - Swizzle 노드: r 채널만 있는 데이터에 rrr이라고 입력하면 (r, r, r) 값을 가지는 float3 데이터가 출력
    - rg 데이터에 rrgg라고 입력하면 (r,r,g,g) float4 출력

---

## 정리

|기능 |	언리얼 | 유니티 |
|---|---|---|
|채널 분리	| Component Mask로 직관적	| Swizzle 노드로 유연함 |
|채널 결합	|Append Vector가 매우 편리하고 강력함	| Split + Combine으로 다소 번거로움 |
|채널 스위즐링	| 기능이 제한적이라 다소 복잡함	| Swizzle 노드가 모든 기능을 지원하여 매우 강력함 |
