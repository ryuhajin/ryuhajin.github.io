---
layout: default
title: "2. BP_cube event Logic"
parent: "generative Motion Design"
nav_order: 2
---

# 2. BP_cube event Logic
블루프린트 이벤트 로직 설정하기

### 만들 함수 및 이벤트
1. function : Disable Parent Cube
    - 충돌 판정, 물리 시뮬레이트 둘 다 off
2. custom event
    - starts split
    - spwan cube

---

# collision & physics

```
Collision : 충돌 감지(쿼리, 물리 반응) 담당

Physics : 시뮬레이션(중력, 질량, 힘 적용)을 담당
```

- [UE - Physics](https://dev.epicgames.com/documentation/en-us/unreal-engine/physics-in-unreal-engine)
- [UE - Collision Overview](https://dev.epicgames.com/documentation/en-us/unreal-engine/collision-in-unreal-engine---overview)


## function : Disable Parent Cube 
물리 충돌판정 없애는 함수 생성

1. **set collision Enabled** : 컴포넌트의 충돌 활성화 수준 설정
    - target : self
    - New Type : No Collision
2. **Set Simulate Physics** : 물리 시뮬레이션 on/off
    - target : self
    - Simulate : 체크 해제
3. **Set collision object Type** : 어떤 종류의 물체인가 정의
    - target : self
    - Channel : world static

---

## 노드 옵션 알아보기
### Set Collision Enabled
컴포넌트의 충돌 활성화 수준을 설정

```
Query = 충돌 감지만
Physics = 물리 계산
Probe = 엔진 내부의 물리 프록시 감지용(일반 게임 로직엔 불필요)
```

<br>

| 옵션 | 설명 |                                                              
| **No Collision** |  충돌 완전 비활성화. <br>• 라인 트레이스(쿼리)에도 반응하지 않음 <br>• 물리 시뮬레이션 충돌 계산도 안 함 |
| **Query Only (No Physics Collision)** | **라인 트레이스, 오버랩 이벤트 등 쿼리만 가능.** <br>물리 반응(충돌, 반발력)은 없음|
| **Physics Only (No Query Collision)** | **물리 엔진만 작동.** <br>쿼리(라인 트레이스, 오버랩 이벤트)는 무시됨 |
| **Query and Physics** | **쿼리 + 물리 모두 활성화.** <br>보통의 물체(예: 움직이는 상자)의 기본 상태|
| **Probe Only** | 주로 **Physics Probe 테스트 전용**.<br>엔진 내부에서 디버깅용이나 Probe 기반 시스템(예: Chaos Scene Query)에서 사용. <br>실제 게임 로직에서는 거의 사용 안 함. |
| **Query and Probe** | 쿼리와 프로브 시스템 모두 반응. <br>일반적인 개발자는 **Query and Physics**만 사용하면 충분 |

---

### Set Simulate Physics
물리 시뮬레이션 활성화, 비활성화 선택

```
SimulatePhysics = true → 물리 세계의 강체(RigidBody)

SimulatePhysics = false → 위치가 코드/애니메이션에 의해 결정되는 오브젝트
```

<br>

| 상태  | 설명  |
| **Simulate = False (기본값)** | 정적 상태.<br>• 위치는 Transform으로 제어.<br>• 중력·힘·질량 영향 없음.<br>• 다른 물체와 충돌은 “정지된 오브젝트”로만 인식 |
| **Simulate = True**  | 물리 엔진에 의해 제어됨.<br>• 중력, 관성, 힘 적용.<br>• Transform으로 직접 제어 불가 (SetWorldLocation은 무시되거나 경고 발생).<br>• Mobility 자동으로 `Movable`로 변경 |


⚠️ **주의**

1. Simulate Physics를 켜도 **콜리전 바디(단순 충돌체)가 없으면 움직이지 않음**
2. **Use Complex Collision as Simple이 켜진 메시에는 시뮬 불가**
3. **World Static 객체에선 비활성 상태 유지**됨

---

### Set Collision Object Type
**자기자신의 물체를 정의**하고 **다른 물체의 Response To Channels 규칙과 조합되어 최종 충돌 여부가 결정**

- 기본 충돌 로직

```
ObjectType_A vs ObjectType_B → B의 ResponseToChannels[A]
```

```
WorldDynamic이 WorldStatic에 닿을 때

- WorldStatic의 ResponseToChannels[WorldDynamic] 설정에 따라 Block/Overlap/Ignore 결정
```

<br>

| 채널(Object Type)  | 설명 | 주 사용 예|
| **WorldStatic**  | 움직이지 않는 고정 오브젝트. <br>지형, 건물, 벽 등. <br>기본적으로 다른 모든 물체와 Block. | 지형, 벽, 도로   |
| **WorldDynamic** | 움직일 수 있는 물체. <br>물리 반응 가능. | 상자, 문, 가구            |
| **Pawn**         | 플레이어 또는 NPC 캐릭터. <br>특정 프리셋(Visibility 등)에 다른 응답을 가짐.        | 캐릭터, AI              |
| **Visibility**   | 주로 **라인 트레이스 전용 채널**. <br>“보이는가?” 테스트용.| 카메라 시야, 타겟팅, 총알 히트스캔 |
| **Camera**       | 카메라 충돌 전용. <br>카메라 클리핑 방지에 사용.    | 3인칭 시점 카메라 충돌        |
| **PhysicsBody**  | 강체 물리 오브젝트 전용. <br>Physics Simulation 켜진 객체가 주 대상.  | 물리 상자, 폭탄 조각|
| **Vehicle**      | 차량용. <br>차량끼리 혹은 특정 표면에만 반응하도록 설정할 때 사용.   | 자동차, 탱크     |
| **Destructible** | 파괴 가능한 오브젝트용. <br>Chaos Destruction 시스템에서 주로 사용.    | 파괴 가능한 벽, 건물 조각      |

---

### 오브젝트 충돌, 물리 설정 기본 패턴

| 의도  | 설정 예시  |
| --- | --- |
| **완전 비활성화**              | Collision: `No Collision`<br>Physics: `Simulate False` |
| **시각적 존재만 유지 (트레이스 허용)** | Collision: `Query Only`                                |
| **물리만 멈추기 (충돌은 유지)**     | Collision: `Query and Physics`<br>Simulate: `False`    |
| **완전 비활성 + 숨김**          | 위 설정 + `Set Hidden In Game(True)`                      |

---

# Spawn cube
큐브 스폰하기

## 사용한 노드 설명
### For Each Loop
배열(Array) 의 모든 요소를 순서대로 순회

> 각 반복에서 Array Element와 Array Index를 반환하고, 마지막 요소가 끝나면 Completed 핀이 실행

### For Loop
for문 노드. for loop with break 노드도 있다

```
For Loop: 정해진 횟수 반복

For Each Loop: 배열 요소 반복
```

---

### Relative Scale 3D
부모(SceneComponent) 기준의 스케일 비율

> 이 컴포넌트가 부모의 크기 대비 얼마나 확대/축소되어 있는지를 나타냄

---

### 기본 Transform
언리얼의 모든 컴포넌트(SceneComponent)는 Transform을 가짐

- 각각 Relative(상대값) 과 World(절대값) 버전이 존재
- Relative(상대값)는 부모 기준으로 계산됨

| 항목                    | 의미                | 상대 기준   |
| --------------------- | ----------------- | ------- |
| **Relative Location** | 부모 위치를 원점으로 한 오프셋 | 부모의 좌표계 |
| **Relative Rotation** | 부모의 회전 기준 각도      | 부모의 방향  |
| **Relative Scale 3D** | 부모의 크기에 대한 배율     | 부모의 스케일 |

---

## 그래프 예제

1. 씬 컴포넌트 오브젝트 레퍼런스에서 트랜스폼 카테고리의 `Relative Scale 3D` 가져오기 (자식의 상대적 크기)
2. `get actor scale 3d` 가져오기 (부모)
3. 1번 * 2번으로 World Scale 만들기

```
World Scale (자식) = Parent.World Scale × Child.Relative Scale
```

- **점점 크기가 줄어드는 이유**

```
부모: Scale 1
 └─ 자식: Relative 0.5 → 1 * 0.5 = 월드 0.5
      └─ 손자: Relative 0.5 → 0.5 * 0.5 = 월드 0.25
          └─ 증손자: Relative 0.5 → 0.25 * 0.5 = 월드 0.125
```

---

## Spawn Actor
새 액터 인스턴스를 월드에 생성하는 노드

**입력**
1. Class: 생성할 액터 유형(예: BP_Cube)
2. Spawn Transform: 위치(Location), 회전(Rotation), 크기(Scale)
3. **Collision Handling Override: 스폰 시 충돌 처리 옵션**
    - **Always Spawn, ignore Collisions**: 충돌 무시하고 생성
    - **Try to Adjust Location, But Always Spawn**: 가능한 스폰 위치 조정하여 스폰
    - **Try to Adjust LocationAd, don't spawn if colliding**: 가능한 스폰 위치 조정. 충돌 시 생성 안 함
    - **Do not spawn**: 충돌이 있으면 스폰하지 않음
4. **Transform Scale : 스폰 시점에 입력 Transform의 스케일값을 루트 컴포넌트에 어떻게 적용할지 결정**
    - **Multiply Scale With Root Component Scale** : 입력 Transform의 스케일을 루트 컴포넌트의 스케일과 곱
      - 최종 스케일 = 루트 스케일 * Transform 스케일
    - **Override Root Component Scale** : 루트 컴포넌트의 스케일을 스폰 Transform의 스케일로 완전히 덮어씀


**출력**
Return Value: 스폰된 액터의 레퍼런스

---

# 그래프 예제

나중에 추가