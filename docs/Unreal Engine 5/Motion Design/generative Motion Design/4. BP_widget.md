---
layout: default
title: "4. BP_widget"
parent: "generative Motion Design"
nav_order: 4
---

# 4. BP_widget

- [UE - widget Buleprint](https://dev.epicgames.com/documentation/ko-kr/unreal-engine/widget-blueprints-in-umg-for-unreal-engine?application_version=5.5)

---

# Input Action
언리얼 5.1에 추가된 Enhanced Input(향상된 입력) 시스템

- [언리얼 엔진의 9가지 입력 트리거](https://youtu.be/MN-0otRNmZI?si=twMQ0o1iBJbqs3mu)

---

## Enhanced Input 구조
1. **Input Mapping Context(IMC)**
    - 어떤 키/버튼이 **어떤 Input Action을 트리거할지를 정의**하는 데이터 자산
2. **Input Action(IA)**
    - 논리적인 행동 단위 (예: Pause, Start, ChangeStyle 등)
3. **BP Event**
    - 어떤 Input Action이 들어왔을 때 실행할 로직

### 액션 기준으로 생각하기
논리 행동(Action) 기준으로 설계

- 키는 단지 그 **행동을 트리거하는 여러 입력 장치 중 하나**

```
Pause → ESC, 게임패드 Start, UI 버튼

Start → Enter, 게임패드 A, UI 버튼

ChangeStyle → 키보드 숫자, UI 버튼, 마우스 휠 등
```

> 한 액션에 여러 키를 묶어서 사용하는 것이 향상된 인풋의 기본 철학

---

## 사용 예제
### IA_Pause
1. **IMC**
    - ESC, Gamepad Start 등 여러 키를 이 액션에 묶음
2. **BP**
    - Enhanced Input Action Event: IA_Pause → TogglePause() 한 번만 구현

---

## Input Action 추가
1. **Input Action 생성**
    - 콘텐츠 브라우저에서 우클릭 후 **Input > Input Action**을 선택해 IA_Interact 같은 액션 생성
2. **Input Mapping Context 생성**
    - **Input > Input Mapping Context**를 선택해 IMC_Main 같은 매핑 컨텍스트 생성
    - 액션과 원하는 키(예: 'E' 키)를 매핑

---

## 구성 요소

| 구성 요소 |	설명 |
|---|---|
Input Action (입력 액션)	|	게임 내에서 발생하는 특정 동작을 추상화한 단위 <br> (예: IA_Interact, IA_Move)  <br> 키를 할당하지 않고, 어떤 타입의 값을 처리할지 정의 |	
Value Type (값 타입)	| 입력 액션이 전달할 데이터 형태 <br> Bool(On/Off), Axis1D(float), Axis2D(FVector2D), Axis3D(FVector) 중 선택 |	
Input Mapping Context  (입력 매핑 컨텍스트, IMC)	|	Input Action과 실제 키보드/마우스/게임패드 키를 연결해주는 매핑 테이블 <br> 우선순위를 설정해 상황에 따라 다른 IMC를 활성화할 수 있음 |	
Trigger (트리거)	| 입력이 활성화되는 조건을 정의합니다 <br> (예: 누르는 순간(Pressed), 뗄 때(Released), 길게 누르기(Hold)) |	
Modifier (모디파이어)	|	원시 입력 값을 게임에 맞게 변환 <br> (예: 값 반전, 스무딩, 데드존 적용)|	

---

## Input Action 속성
작동 순서: 입력은 모디파이어(값 전처리) → 트리거(조건 판정) 순서로 처리

---

### Trigger (트리거)
입력이 "언제, 어떤 조건에서" 유효한지 정의하는 조건 필터

### 트리거 배열
하나의 Input Action에 여러 개의 트리거를 **중첩해서 적용**할 수 있게 해주는 기능이다

- **AND 조건처럼 작동**하여, 배열에 추가된 **모든 트리거의 조건을 동시에 만족해야만 해당 입력이 최종적으로 유효하게 판정**됨

---

트리거 | 타입 설명 | 주요 설정 옵션 |
|---|---|---|
Pressed	|	키를 **누른** 순간 한 번만 감지	|	Actuation Threshold: 입력이 유효하기 위한 최소 값|
Released	|	키를 **뗀** 순간 한 번만 감지 |	Value Threshold: 키가 '떼어졌음'으로 판단되는 기준 값|
Hold	|	키를 **일정 시간 이상 누른** 상태에서 감지 |	Hold Time Threshold: 유효로 판단할 최소 누르기 시간|
Hold & Release|		**Hold 조건을 만족한 후 키를 뗄 때** 감지 |	Hold Time Threshold: 최소 누르기 시간|
Tap	|	키를 **아주 짧게 누르고 뗐을 때** 감지 |	Tap Time Threshold: '탭'으로 인정할 최대 시간|
Pulse	|	키를 **누르고 있는 동안 일정 간격으로 반복** 감지 |	Interval: 펄스 발생 간격(초)|
Chorded Action	|	특정 **다른 입력이 이미 눌려 있는 상태에서만 감지** |	Chording Action: 선행 조건이 될 다른 Input Action을 지정|

---

### Modifier (모디파이어)
입력 값을 전달하기 전에 가공하는 전처리기. 적용 순서대로 여러 개를 체인처럼 추가할 수 있음


모디파이어 타입 | 설명 |	주요 설정 옵션|
|---|---|---|
Dead Zone | 조이스틱의 미세 움직임 등 잡음을 제거	| Lower Threshold(무시할 최소 값), Upper Threshold(최대 입력 범위), Type(적용 축)|
Negate | 입력 값의 부호를 반전 (예: W를 +1, S를 -1로 변환) |	Negate X, Y, Z: 반전시킬 축을 개별 선택|
Swizzle | 입력 축(X, Y, Z)을 교환하거나 재배열 |	Order: 축의 새로운 배치 순서를 선택 (예: "YX"는 Y축 입력을 X축 값으로 전달)|
Scale | 입력 값에 일정 배율을 곱함 | Scalar: 곱할 배율 (예: 마우스 감도 2배)|
Smooth | 여러 프레임에 걸쳐 입력 값을 부드럽게 만듦 | Sample Period (Secs): 평균을 구할 시간|
Response Curve | 입력 값과 출력 값의 관계를 커브로 제어 |Curve: 커브 에셋을 연결|
To World Space | 로컬 입력 방향을 월드 공간 방향으로 변환 |	- |

---

## PlayerColntroller 와 연동
PlayerController 블루프린트에서 IMC 활성화

1. **PlayerController 블루프린트 열기**
    - Event BeginPlay 노드를 추가
    - **Get Player Controller -> Get Enhanced Input Local Player Subsystem -> Add Mapping Context 노드를 연결**
    - Add Mapping Context 노드의 첫 번째 핀에 1단계에서 만든 IMC_Main을
    - 두 번째 핀에는 우선순위(기본값 0)를 연결
2. **Input Action 이벤트 연결 및 처리**
    - 이벤트 그래프 우클릭, IA_Interact(또는 생성한 액션 이름)을 검색
    - 검색 결과 중 Enhanced Input Action 타입의 이벤트를 선택해 그래프에 추가
    - 해당 이벤트 노드에는 Started(누른 순간), Triggered(누르고 있는 동안, 매 프레임), Completed(뗀 순간) 등 여러 실행 핀이 있음
    - 원하는 핀(예: Started)에 로직(예: Print String으로 "E Pressed" 출력) 연결

---

## EnhancedInputAction 노드
액션의 현재 스테이트에 바인딩하기

- [UE - enhancedinput](https://dev.epicgames.com/documentation/ko-kr/unreal-engine/enhanced-input-in-unreal-engine)

1. 트리거(Triggered)
    - 액션이 트리거 됨
    - 즉, 모든 트리거 요구 사항 평가를 완료했다는 뜻
    - 예를 들어, 사용자가 키를 놓으면 '키 누르고 떼기(Press and Release)' 트리거가 전송
2. 시작(Started)
    - 트리거 평가를 시작한 이벤트가 발생
    - 예를 들어, '두 번 탭(Double tap)' 트리거를 처음 누르면 '시작됨' 스테이트가 한 번 호출
3. 진행 중 (ongoing)
    - 트리거를 여전히 처리 중
    - 예를 들어, 지정된 기간이 끝나기 전에 사용자가 버튼을 누르고 있는 동안에는 '길게 누르기(Press and hold)' 액션이 진행 중
    - 이 이벤트는 트리거에 따라 입력 값을 수신하면 작업이 평가되는 동안 틱마다 발동
4. 취소(Canceled)
    - 트리거링이 취소
    - 예를 들어, 사용자가 '길게 누르기' 액션이 트리거되기 전에 버튼을 놓는 경우가 있음
5. 완료(Completed)
    - 트리거 평가 프로세스가 완료

---
