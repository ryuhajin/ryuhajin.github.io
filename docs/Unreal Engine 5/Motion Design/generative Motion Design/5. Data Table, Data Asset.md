---
layout: default
title: "5. Data Table, Data Asset"
parent: "generative Motion Design"
nav_order: 5
---

# 5. Data Table, Data Asset
테마별로 포스트 프로세스 볼륨, 머티리얼, VFX 바꾸기 위한 준비

**링크**
- [UE - 아이템 및 데이터 관리](https://dev.epicgames.com/documentation/ko-kr/unreal-engine/manage-item-and-data-in-an-unreal-engine-game)
- - [UE - 데이터 기반 게임 플레이](https://dev.epicgames.com/documentation/ko-kr/unreal-engine/data-driven-gameplay-elements-in-unreal-engine)

---

# Data Table
스프레드 시트 형태의 데이터 집합

- 단순한 읽기 전용 데이터 목록 (아이템, 경험치 등)

```
DataTable
 ├── RowName: "Sword"
 │    └── Struct Instance (예: FItemData)
 │          ├── Name: "Sword"
 │          ├── Damage: 50
 │          └── Weight: 5.0
 ├── RowName: "Bow"
 │    └── Struct Instance (FItemData)
 │          ├── Name: "Bow"
 │          ├── Damage: 25
 │          └── Weight: 2.0
```

## Data Table 개념
1. 데이터 테이블은 객체임
2. **데이터 테이블의 각 행은 구조체를 기반으로 함**
    - 모든 행은 동일한 구조를 가져야 함
    - 이 구조를 정의하기 위해 언리얼에서는 구조체(Struct)를 사용
3. **CSV나 JSON을 읽어 행(Row) 단위의 구조체 집합으로 import 가능**
4. 언리얼 에디터에서 직접 표 형태로 열·행 편집 가능

---

## ⚠️ 주의사항
1. **데이터 테이블은 런타임 수정 불가**
    - 읽기 전용이므로 게임 중 데이터 변경시 변수에 복사해서 사용
2. 대용량 데이터 주의
    - **데이터 테이블은 순차적으로 데이터를 찾음**
    - 따라서 테이블이 커질수록 테이블에서 찾는 시간을 고려해야 함

---

## 구조체 예시
DataTable은 내부적으로 `TMap<FName, FTableRowBase*>` 형태로 저장

- RowName :key
- 구조체 (예: FItemData)의 포인터 : value

> 테이블 생성 시 어떤 구조체를 기반으로 할지 지정

```c++
UDataTable* MyTable = NewObject<UDataTable>();
MyTable->RowStruct = FItemData::StaticStruct();
```

- 이후 행을 추가하거나 불러올 때는 항상 RowStruct의 타입과 일치해야함

```c++
USTRUCT(BlueprintType)
struct FItemData {
    GENERATED_BODY()

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    FString Name;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    UStaticMesh* Mesh;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    TSubclassOf<AActor> ActorClass;

    UPROPERTY(EditAnywhere, BlueprintReadWrite)
    int32 Price;
};
```

- 해당 구조체 기반으로 DataTable 생성

| RowName | Name   | Mesh      | ActorClass    | Price |
| ------- | ------ | --------- | ------------- | ----- |
| Sword   | Sword  | SM_Sword  | BP_Sword      | 100   |
| Shield  | Shield | SM_Shield | BP_Shield     | 120   |
| Potion  | Potion | None      | BP_HealPotion | 30    |

---

## Data table 생성
1. **데이터 테이블 Row에 쓰일 구조체 만들기**
    - 콘텐트 브라우저 우클릭 -> 블루프린트 -> 구조체
2. **구조체 설정** : `S_` 접두사
    - 변수 추가 버튼으로 구조체 데이터 추가
3. **구조체로 데이터 테이블 만들기** : `DT_` 접두사
    - 콘텐트 브라우저 우클릭 -> 블루프린트 -> 데이터 테이블
    - 사용하고 싶은 구조체 선택
4. **구조제 테이블에 데이터 추가하기**
    - Row name : key
    - Data table details : 구조체 설정 볼 수 있음
    - Add 버튼을 통해 테이블에 데이터 추가

---

## 블루프린트에서 Data table 값 가져오기
1. **Get Data Table Row Names** : 데이터 테이블의 모든 행 이름 목록을 가져옴
    - Table : 가져오고 싶은 테이블 선택
    - Out Row names : 데이터 테이블 배열
2. **Get Data Table Row** : 특정 행의 데이터 가져오기
    - Out Row : 가져온 행 데이터
3. **Break YourStruct**
    - 행 데이터 구조체 데이터 사용

---

# Data Asset
**단일 객체**를 위한 데이터 컨테이너로, UObject를 상속받아 만들어짐

- 데이터 에셋은 하나의 복합적인 객체를 정의하는 데 사용

---

## Data Asset 개념
1. 특정 클래스(보통 UDataAsset 혹은 UPrimaryDataAsset 상속)의 **인스턴스를 에디터에서 에셋 파일로 저장**
2. 구조체(USTRUCT)나 변수들을 멤버로 가지며, 이를 하나의 설정 묶음처럼 사용
    - 예: 캐릭터 스탯, 무기 설정, 레벨 테마, UI 색상 팔레트 등

## Data Asset 특징
1. **형태**: 오브젝트 에셋(.uasset)
2. **타입 안전성**: 변수형, Enum 등 완전히 타입 보장
3. **편집 친화적**: 세부 설정값을 언리얼 에디터에서 바로 노출·수정 가능
4. **참조 가능성**: 블루프린트나 C++에서 직접 DataAsset 변수로 참조 가능
5. Primary Data Asset은 Asset Manager와 연동되어 런타임 로딩/관리용으로 권장

---

## data Table vs Data asset

| 항목     | Data Asset       | Data Table        |
| ------ | ---------------- | ----------------- |
| 목적     | 개별 설정 묶음         | 다수의 동일 구조 데이터 관리  |
| 구조     | UObject 기반 클래스   | struct 기반 표 형식       |
| 확장성    | 상속, 오버라이드 용이     | 정해진 구조 내 행 추가     |
| 데이터 수  | 소량 (수~수십 개)      | 대량 (수백~수천 행)      |
| 편집 방식  | 세부 필드 에디트        | 표 편집 (CSV/에디터)    |
| 접근 방식  | 에셋 직접 참조         | Row Name으로 검색 (키 값으로 검색)     |
| 이상적 용도 | 캐릭터 클래스, 스킬, 퀘스트 | 아이템 목록, 경험치 테이블 등 |

---

## Data Asset 생성
1. **블루프린트 클래스 생성 -> 클래스 선택 창에서 data asset 검색 -> primary data asset 선택**
    - 변수 추가 : 변수 기본값 설정 가능
    - 함수 추가 : 모든 인스턴스가 해당 함수 사용 가능
2. **콘텐트 브라우저 우클릭 -> 기타 -> 데이터 에셋으로 1번에서 생성한 primary data asset 선택**
3. **데이터 에셋 인스턴스 생성**
    - primary data asset의 변수와 함수 복사됨
    - 데이터 에셋 인스턴스들은 각각 다른 값을 가질 수 있음 (동일 구조, 값 개별)

```
PDA_WeaponBase : PrimaryDataAsset
    - 변수: WeaponName, Damage, Mesh, FireSound
    - 함수: GetDPS()

DA_Sword, DA_Bow, DA_Staff : PDA_WeaponBase 기반 데이터 에셋
    - Damage, mesh, FireSound 값이 각각 다름
    - 함수 GetDPS()는 공통 로직 사용
```

---

## 블루프린트에서 Data asset 값 가져오기
1. 블루프린트 변수 추가 후 type 검색 -> primary data asset 이름 검색 가능
2. 해당 변수 눈 아이콘 클릭하여 인스턴스 편집 가능하게 두기
3. 블루프린트 액터마다 데이터 에셋 선택 가능