---
layout: default
title: "8. Specular Lighting"
parent: "ResterTekTutorial"
nav_order: 9
---

# 8. Specular Lighting (정반사광)
매끄럽거나 광택이 나는 표면에서 **빛이 특정 방향으로 강하게 반사되어 생기는 하이라이트를 모델링하는 조명**

- 정반사광은 빛이 거울처럼 특정 각도로 반사되어 우리 눈에 직접 들어올 때만 보이는 밝은 빛이다

---

# Specular Lighting을 계산하는 데 필요한 요소들
하이라이트를 계산하려면 셰이더(Shader) 코드에서 몇 가지 벡터와 값이 필요

1. **광원 벡터 (Light Vector, L)**
- 표면의 한 점에서 광원(조명)을 향하는 방향 벡터
2. **표면 노멀 벡터 (Normal Vector, N)**
- 해당 지점의 표면이 바라보는 방향을 나타내는 벡터. 표면에 수직인 방향
3. **시선 벡터 (View Vector, V)**
- 표면의 한 점에서 카메라(눈)를 향하는 방향 벡터
4. **반사 벡터 (Reflection Vector, R)**
- 광원 벡터(L)가 표면의 법선(N)을 기준으로 반대편으로 반사된 방향 벡터
5. **광택도 (Shininess 또는 Roughness)**
- 표면이 얼마나 매끄러운지를 나타내는 값
  - 값이 높을수록: 하이라이트가 작고 날카로움 (예: 금속, 유리)
  - 값이 낮을수록: 하이라이트가 크고 뭉툭 (예: 플라스틱, 고무)

기본적인 퐁(Phong) 조명 모델에서는 다음과 같은 원리로 정반사광을 계산

> - "반사된 빛의 방향(R)과 우리 눈의 방향(V)이 얼마나 가까운가?"
> - 반사 벡터 (R) 과 눈 방향 (V) 의 방향이 일치할 수록 밝은 하이라이트를 갖게 됨
> - 광택도 값을 조절하여 같은 물체라도 다양한 재질의 느낌을 표현

따라서

1. **둘 사이의 각도를 계산하여 하이라이트의 강도를 결정함**
2. **광택도 값을 제곱 연산(power)의 지수로 사용하여 하이라이트의 집중도를 조절**

---

# Blinn-Phong
퐁 모델은 특정 각도에서 계산량이 많아지거나 부자연스러운 결과가 나올 때가 있음. 이를 **개선한 것이 블린-퐁(Blinn-Phong) 모델**

블린-퐁은 반사 벡터(R)를 직접 계산하는 대신, **하프웨이 벡터(Halfway Vector, H) 라는 것을 사용**

> - 하프웨이 벡터(H): 광원 벡터(L)와 시선 벡터(V)의 딱 중간 방향을 가리키는 벡터

블린-퐁 모델은 이 **하프웨이 벡터(H)와 법선 벡터(N)가 얼마나 가까운지를 계산한다**

> - "표면의 방향(N)이 빛과 시선의 중간 방향(H)을 얼마나 정확히 바라보고 있는가?"

계산이 더 효율적이고, 특정 상황에서 더 자연스러운 결과를 보여주기 때문에 현대 그래픽스에서 더 널리 사용됨

---

## Blinn-Phong 계산 원리

## 1. 하프웨이 벡터 (Halfway Vector, H) 계산
정반사광을 계산하려는 표면의 한 점을 기준으로 두 개의 벡터를 구함

- **광원 벡터 (L)**: 표면에서 광원을 향하는 단위 벡터
- **시선 벡터 (V)**: 표면에서 카메라(관찰자)를 향하는 단위 벡터

> 하프웨이 벡터는 위 두 벡터의 정확히 중간 방향을 가리키는 단위 벡터

### 하프웨이 벡터 구하기
- 광원 벡터(L)와 시선 벡터(V) 더하기

$$
H = L + V
$$

- 결과 벡터를 정규화(Normalize)하여 크기를 1로 만들기

$$
H = normalize(L + V)
$$

---

## 2. 하이라이트 강도 계산
하이라이트의 밝기를 결정한다. 

- **법선 벡터 (N)**: 표면에 수직인 단위 벡터
- **하프웨이 벡터(H)**: 중간 방향을 가리키는 단위 벡터
 
> 하프웨이 벡터(H)와 표면의 법선 벡터(N)가 얼마나 같은 방향을 바라보는지를 측정

- 표면의 법선 벡터(N)와 하프웨이 벡터(H)가 얼마나 같은 방향을 향하는지 내적(Dot Product)을 통해 계산
- 이 값은 0과 1 사이의 스칼라 값으로, 하이라이트의 기본 밝기를 결정

---

$$
specular_{intensity}  = max(0, dot(N, H))
$$

---

- 값이 1에 가까울수록 (두 벡터의 방향이 거의 일치), 그 지점은 가장 밝은 하이라이트를 갖게 됨
- 값이 0에 가까울수록 (두 벡터가 수직에 가까울수록), 하이라이트는 거의 보이지 않게 됨

---

## 3. 광택도 적용하기
위에서 구한 **하이라이트 강도 값에 광택도(Shininess) 계수를 적용하여 하이라이트의 크기를 조절**

- **light<sub>color</sub>**: 광원의 색상
- **specular<sub>color</sub>**: 재질이 반사하는 빛의 색상 (Ks)
- **shininess**: 광택 계수. 값이 클수록 하이라이트가 더 작고 날카로워짐

---

$$
specular_{final} = light_{color} \times specular_{color} \times (specular_{intensity})^{shininess}
$$

---

